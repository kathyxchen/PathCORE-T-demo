{% extends "layout.html" %}
{% block title %}PathCORE network{% endblock %}
{% block head %}
  {{ super() }}
  <style type="text/css">
  html, body {
  }

  .link {
    stroke: #000;
    opacity: 0.5;
  }

  .node {
    stroke: #fff;
  }

  .node text {
    pointer-events: none;
    font: 14px sans-serif;
    fill: white;
    stroke: gray;
  }
  </style>
  <script src="{{ url_for('static', filename='js/pathcore.js') }}"></script>
{% endblock %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="container">
            <h3>{{title}}</h3>
        </div>
    </div>
    {% include "network.html" %}
</div>
</body>

<script>
/* initialize the random seed to make the PathCORE network layout
 * load in the same way every time.
 */
Math.seedrandom("10pa4t5hcoRE");

const target = "#pathcore";
const width  = 960;
const height = Math.max($(window).height() - 10, 500);
const svg = d3.select(target).append("svg")
  .attr("width", width)
  .attr("height", height);
const force = d3.layout.force()
  .charge(-180)
  .size([width, height]);

const networkFilename = "{{ filename }}";
const filepath = "{{ url_for('static', filename='data/' + filename) }}";

// event listener for the search bar
$("#searchbar").keypress(function(e) {
  $(".err-message").hide();
  if (e.which == 13) {
    $("button").click();
    return false;
  }
});


d3.tsv(filepath, function(error, links) {
  if (error) throw error;
  loadPathCORENetwork(links, force, svg);
});

</script>
{% endblock %}
